# YTB2BILI - YouTube åˆ° Bilibili è‡ªåŠ¨åŒ–è½¬è½½ç³»ç»Ÿ

ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„è§†é¢‘è‡ªåŠ¨åŒ–å¤„ç†ç³»ç»Ÿï¼Œæ”¯æŒä» YouTube ç­‰å¹³å°ä¸‹è½½è§†é¢‘ï¼Œè‡ªåŠ¨ç”Ÿæˆå­—å¹•ã€ç¿»è¯‘å†…å®¹ã€ç”Ÿæˆå…ƒæ•°æ®ï¼Œå¹¶å®šæ—¶ä¸Šä¼ åˆ° Bilibiliã€‚

## âœ¨ æ ¸å¿ƒåŠŸèƒ½

### ğŸ¬ æ™ºèƒ½è§†é¢‘å¤„ç†é“¾

**4æ­¥å‡†å¤‡æµç¨‹ï¼ˆå®æ—¶å¤„ç†ï¼‰**ï¼š
1. **ğŸ¬ å­—å¹•ç”Ÿæˆ** - ä½¿ç”¨ Whisper AI è‡ªåŠ¨ç”Ÿæˆé«˜è´¨é‡å­—å¹•
2. **ğŸ“· å°é¢ä¸‹è½½** - è‡ªåŠ¨ä¸‹è½½å¹¶ä¸Šä¼ é«˜æ¸…å°é¢åˆ°äº‘å­˜å‚¨
3. **ğŸŒ å­—å¹•ç¿»è¯‘** - æ”¯æŒç™¾åº¦ç¿»è¯‘å’Œ DeepSeek AI å¤šè¯­è¨€ç¿»è¯‘
4. **ğŸ¤– å…ƒæ•°æ®ç”Ÿæˆ** - AI åˆ†æè§†é¢‘å†…å®¹ï¼Œç”Ÿæˆç¬¦åˆ Bç«™è§„èŒƒçš„æ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾

**å®šæ—¶ä¸Šä¼ ç­–ç•¥ï¼ˆæ™ºèƒ½è°ƒåº¦ï¼‰**ï¼š
- **ğŸ¥ è§†é¢‘ä¸Šä¼ ** - æ¯å°æ—¶ä¸Šä¼ ä¸€ä¸ªå¤„ç†å®Œæˆçš„è§†é¢‘
- **ğŸ“ å­—å¹•ä¸Šä¼ ** - è§†é¢‘ä¸Šä¼ æˆåŠŸå1å°æ—¶è‡ªåŠ¨ä¸Šä¼ å­—å¹•

### ğŸ“Š å¯è§†åŒ–ç®¡ç†é¢æ¿
- **ğŸ“‹ è§†é¢‘åˆ—è¡¨** - å®æ—¶æŸ¥çœ‹æ‰€æœ‰è§†é¢‘çš„å¤„ç†çŠ¶æ€
- **ğŸ” è¯¦ç»†ä¿¡æ¯** - å®Œæ•´çš„è§†é¢‘ä¿¡æ¯å’Œå¤„ç†æ­¥éª¤è¿½è¸ª  
- **ğŸ¯ å•æ­¥é‡è¯•** - æ”¯æŒé‡æ–°æ‰§è¡Œå¤±è´¥çš„ä»»åŠ¡æ­¥éª¤
- **ğŸ“ˆ è¿›åº¦ç›‘æ§** - å®æ—¶è¿›åº¦ç™¾åˆ†æ¯”å’Œå¤„ç†æ—¶é•¿ç»Ÿè®¡
- **ğŸ“ æ–‡ä»¶ç®¡ç†** - æŸ¥çœ‹å’Œä¸‹è½½æ‰€æœ‰ç”Ÿæˆçš„æ–‡ä»¶ï¼ˆè§†é¢‘ã€å­—å¹•ã€å°é¢ç­‰ï¼‰

### ğŸ” Bç«™è´¦æˆ·é›†æˆ
- **ğŸ“± æ‰«ç ç™»å½•** - æ”¯æŒ Bilibili TV æ‰«ç å¿«é€Ÿç™»å½•
- **ğŸ–¼ï¸ äºŒç»´ç ç”Ÿæˆ** - åç«¯è‡ªåŠ¨ç”Ÿæˆ PNG æ ¼å¼ç™»å½•äºŒç»´ç 
- **ğŸ”„ è‡ªåŠ¨æ£€æµ‹** - å‰ç«¯å®æ—¶è½®è¯¢æ£€æµ‹ç™»å½•çŠ¶æ€
- **ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯** - è·å–å¹¶å±•ç¤ºç”¨æˆ·åã€å¤´åƒç­‰ä¿¡æ¯
- **ğŸ’¾ çŠ¶æ€æŒä¹…åŒ–** - è‡ªåŠ¨ä¿å­˜ç™»å½• Token å’Œ Cookie
- **âš¡ çŠ¶æ€æ£€æŸ¥** - æ™ºèƒ½æ£€æµ‹è´¦æˆ·ç™»å½•çŠ¶æ€

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### ğŸ–¥ï¸ åç«¯æŠ€æœ¯æ ˆ
- **è¯­è¨€**: Go 1.24+ (æ”¯æŒæœ€æ–°è¯­è¨€ç‰¹æ€§)
- **Web æ¡†æ¶**: Gin (é«˜æ€§èƒ½HTTPæ¡†æ¶)
- **ORM**: GORM v2 (æ”¯æŒå¤šæ•°æ®åº“)
- **æ•°æ®åº“**: MySQL 8.0+ / PostgreSQL 15+ / SQLite (å¼€å‘ç¯å¢ƒ)
- **æ–‡ä»¶å­˜å‚¨**: è…¾è®¯äº‘ COS (æ”¯æŒå¤§æ–‡ä»¶åˆ†ç‰‡ä¸Šä¼ )
- **ä¾èµ–æ³¨å…¥**: Uber FX (å£°æ˜å¼ä¾èµ–ç®¡ç†)
- **å®šæ—¶ä»»åŠ¡**: Robfig Cron v3 (ç²¾ç¡®åˆ°ç§’çº§è°ƒåº¦)
- **æ—¥å¿—**: Zap + Lumberjack (ç»“æ„åŒ–æ—¥å¿—å’Œæ—¥å¿—è½®è½¬)

### ğŸŒ å‰ç«¯æŠ€æœ¯æ ˆ 
- **æ¡†æ¶**: Next.js 15+ (æ”¯æŒ App Router)
- **è¯­è¨€**: TypeScript 5.x (å®Œå…¨ç±»å‹å®‰å…¨)
- **UI åº“**: React 18 + Tailwind CSS 3.x
- **å›¾æ ‡**: Lucide React (ç°ä»£åŒ–å›¾æ ‡åº“)
- **HTTP å®¢æˆ·ç«¯**: Axios (æ”¯æŒè¯·æ±‚æ‹¦æˆªå’Œé‡è¯•)
- **æ„å»º**: é™æ€å¯¼å‡º + åµŒå…¥å¼éƒ¨ç½²

### ğŸ”— å¤–éƒ¨æœåŠ¡é›†æˆ
- **ğŸ¤ yt-dlp** - å¤šå¹³å°è§†é¢‘ä¸‹è½½ (YouTube, TikTok, ç­‰)
- **ğŸ§  Whisper AI** - é«˜ç²¾åº¦è¯­éŸ³è¯†åˆ«å’Œå­—å¹•ç”Ÿæˆ
- **ğŸŒ ç™¾åº¦ç¿»è¯‘ API** - ä¸“ä¸šæœºå™¨ç¿»è¯‘æœåŠ¡
- **ğŸ¤– DeepSeek AI** - å…ˆè¿›çš„AIç¿»è¯‘å’Œå†…å®¹ç”Ÿæˆ
- **ğŸ“º Bilibili SDK** - å®˜æ–¹è§†é¢‘ä¸Šä¼ å’Œç”¨æˆ·è®¤è¯API
- **â˜ï¸ è…¾è®¯äº‘ COS** - ä¼ä¸šçº§å¯¹è±¡å­˜å‚¨æœåŠ¡
- **ğŸ“Š æ•°æ®åˆ†æ** - å¯é€‰çš„ç”¨æˆ·è¡Œä¸ºåˆ†æå’Œç»Ÿè®¡

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ytb2bili/
â”œâ”€â”€ main.go                      # ğŸš€ åº”ç”¨ç¨‹åºå…¥å£å’Œä¾èµ–æ³¨å…¥é…ç½®
â”œâ”€â”€ Makefile                     # ğŸ“¦ è‡ªåŠ¨åŒ–æ„å»ºè„šæœ¬ (å‰ç«¯+åç«¯ä¸€é”®æ‰“åŒ…)
â”œâ”€â”€ config.toml                  # âš™ï¸ ä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ config.toml.example          # ğŸ“‹ é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ go.mod                       # ğŸ“¦ Go æ¨¡å—ä¾èµ–ç®¡ç†
â””â”€â”€ README.md                    # ğŸ“– é¡¹ç›®æ–‡æ¡£

internal/                        # ğŸ  å†…éƒ¨ä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ chain_task/                  # â›“ï¸ ä»»åŠ¡é“¾å¤„ç†å¼•æ“
â”‚   â”œâ”€â”€ chain_task_handler.go    # ä»»åŠ¡é“¾æ‰§è¡Œå™¨ (å‡†å¤‡é˜¶æ®µ: å­—å¹•ç”Ÿæˆâ†’ç¿»è¯‘â†’å…ƒæ•°æ®)
â”‚   â”œâ”€â”€ upload_scheduler.go      # ä¸Šä¼ è°ƒåº¦å™¨ (å®šæ—¶ä¸Šä¼ : è§†é¢‘â†’å­—å¹•)
â”‚   â”œâ”€â”€ base/
â”‚   â”‚   â””â”€â”€ base_task.go         # ä»»åŠ¡åŸºç±»
â”‚   â”œâ”€â”€ handlers/                # ğŸ”§ å…·ä½“ä»»åŠ¡å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ generate_subtitles.go      # å­—å¹•ç”Ÿæˆ (Whisper AI)
â”‚   â”‚   â”œâ”€â”€ translate_subtitle.go      # å­—å¹•ç¿»è¯‘ (ç™¾åº¦/DeepSeek)
â”‚   â”‚   â”œâ”€â”€ generate_metadata.go       # å…ƒæ•°æ®ç”Ÿæˆ (AIæ ‡é¢˜æè¿°)
â”‚   â”‚   â”œâ”€â”€ download_img_handler.go    # å°é¢ä¸‹è½½å¤„ç†
â”‚   â”‚   â”œâ”€â”€ upload_to_bilibili.go      # è§†é¢‘ä¸Šä¼ åˆ°Bç«™
â”‚   â”‚   â”œâ”€â”€ upload_subtitle_to_bilibili.go  # å­—å¹•ä¸Šä¼ åˆ°Bç«™
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ manager/
â”‚       â”œâ”€â”€ chain.go             # ä»»åŠ¡é“¾ç®¡ç†
â”‚       â””â”€â”€ state.go             # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ core/                        # ğŸ¯ æ ¸å¿ƒä¸šåŠ¡å±‚
â”‚   â”œâ”€â”€ app_server.go            # HTTP æœåŠ¡å™¨é…ç½®
â”‚   â”œâ”€â”€ models/                  # ğŸ“Š æ•°æ®æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_video.go          # è§†é¢‘è¡¨æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_task_step.go      # ä»»åŠ¡æ­¥éª¤æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ tb_user.go           # ç”¨æˆ·æ¨¡å‹
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ services/                # ğŸ”„ ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”‚   â”œâ”€â”€ tb_video_service.go  # è§†é¢‘ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”œâ”€â”€ task_step_service.go # ä»»åŠ¡æ­¥éª¤ç®¡ç†
â”‚   â”‚   â””â”€â”€ saved_video_service.go
â”‚   â””â”€â”€ types/
â”‚       â”œâ”€â”€ app_config.go        # åº”ç”¨é…ç½®å®šä¹‰
â”‚       â””â”€â”€ task_interface.go    # ä»»åŠ¡æ¥å£å®šä¹‰
â”œâ”€â”€ handler/                     # ğŸŒ HTTP è¯·æ±‚å¤„ç†å™¨
â”‚   â”œâ”€â”€ auth_handler.go          # è®¤è¯ç›¸å…³ API
â”‚   â”œâ”€â”€ video_handler.go         # è§†é¢‘ç®¡ç† API
â”‚   â”œâ”€â”€ upload_handler.go        # ä¸Šä¼ ç›¸å…³ API
â”‚   â”œâ”€â”€ subtitle_handler.go      # å­—å¹•å¤„ç† API
â”‚   â””â”€â”€ ...
â”œâ”€â”€ storage/                     # ğŸ’¾ å­˜å‚¨æŠ½è±¡å±‚
â”‚   â”œâ”€â”€ interfaces.go            # å­˜å‚¨æ¥å£å®šä¹‰
â”‚   â””â”€â”€ login_store.go           # ç™»å½•çŠ¶æ€å­˜å‚¨
â””â”€â”€ web/                         # ğŸŒŸ å†…åµŒå‰ç«¯èµ„æº
    â”œâ”€â”€ static.go                # é™æ€æ–‡ä»¶æœåŠ¡å™¨
    â””â”€â”€ bili-up-web/             # Next.js ç¼–è¯‘åçš„é™æ€æ–‡ä»¶
        â”œâ”€â”€ index.html           # å‰ç«¯å…¥å£é¡µé¢
        â”œâ”€â”€ _next/               # Next.js é™æ€èµ„æº
        â””â”€â”€ ...

pkg/                             # ğŸ“š å¯é‡ç”¨ç»„ä»¶åº“
â”œâ”€â”€ analytics/                   # ğŸ“Š æ•°æ®åˆ†æå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client.go
â”‚   â””â”€â”€ middleware.go
â”œâ”€â”€ cos/                         # â˜ï¸ è…¾è®¯äº‘COSå­˜å‚¨å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ cos_client.go
â”‚   â”œâ”€â”€ cos_handler.go
â”‚   â””â”€â”€ download_utils.go
â”œâ”€â”€ logger/                      # ğŸ“ æ—¥å¿—ç»„ä»¶
â”‚   â””â”€â”€ logger.go
â”œâ”€â”€ services/                    # ğŸ› ï¸ é€šç”¨æœåŠ¡
â”‚   â””â”€â”€ subtitle_service.go
â”œâ”€â”€ store/                       # ğŸ—ƒï¸ æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ database.go              # æ•°æ®åº“è¿æ¥
â”‚   â”œâ”€â”€ migrate.go               # æ•°æ®åº“è¿ç§»
â”‚   â””â”€â”€ model/                   # æ•°æ®åº“æ¨¡å‹
â”œâ”€â”€ translator/                  # ğŸŒ ç¿»è¯‘æœåŠ¡
â”‚   â”œâ”€â”€ baidu_translator.go      # ç™¾åº¦ç¿»è¯‘
â”‚   â”œâ”€â”€ deepseek_translator.go   # DeepSeekç¿»è¯‘
â”‚   â”œâ”€â”€ factory.go               # ç¿»è¯‘å™¨å·¥å‚
â”‚   â””â”€â”€ manager.go               # ç¿»è¯‘ç®¡ç†å™¨
â””â”€â”€ utils/                       # ğŸ§° å·¥å…·å‡½æ•°
    â”œâ”€â”€ crypto.go                # åŠ å¯†å·¥å…·
    â”œâ”€â”€ ffmpeg_utils.go          # è§†é¢‘å¤„ç†å·¥å…·
    â”œâ”€â”€ youtube_utils.go         # YouTubeå·¥å…·
    â”œâ”€â”€ ytdlp_manager.go         # yt-dlpç®¡ç†å™¨
    â””â”€â”€ ...
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### âš¡ ä¸€é”®éƒ¨ç½² (æ¨è)

```bash
# å…‹éš†é¡¹ç›® (éœ€è¦å‰ç«¯é¡¹ç›®åœ¨åŒçº§ç›®å½•)
git clone https://github.com/difyz9/ytb2bili.git
cd ytb2bili/bili-up-api

# ä¸€é”®æ„å»º (è‡ªåŠ¨æ„å»ºå‰ç«¯+åç«¯å¹¶æ‰“åŒ…æˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶)
make build

# å¯åŠ¨æœåŠ¡
./bili-up-api-server
```

ğŸ‰ **å°±è¿™ä¹ˆç®€å•ï¼** è®¿é—® `http://localhost:8096` å³å¯ä½¿ç”¨å®Œæ•´åŠŸèƒ½ã€‚

> **ğŸ’¡ æ„å»ºåŸç†**: `make build` ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ­¥éª¤ï¼š
> 1. ğŸ”§ æ„å»º Next.js å‰ç«¯ (`npm run build`)
> 2. ğŸ“¦ å°†é™æ€æ–‡ä»¶åµŒå…¥åˆ° Go äºŒè¿›åˆ¶ä¸­
> 3. ğŸš€ ç¼–è¯‘ç”Ÿæˆå•ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ (çº¦ 50MB)
> 4. âœ… é›¶ä¾èµ–éƒ¨ç½²ï¼Œå¼€ç®±å³ç”¨

### ğŸ“‹ ç¯å¢ƒè¦æ±‚

| ç»„ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ç”¨é€” |
|------|----------|------|
| **Go** | 1.24+ | åç«¯è¿è¡Œç¯å¢ƒ |
| **Node.js** | 18+ | å‰ç«¯æ„å»º (ä»…æ„å»ºæ—¶éœ€è¦) |
| **æ•°æ®åº“** | MySQL 8.0+ / PostgreSQL 15+ / SQLite | æ•°æ®å­˜å‚¨ |
| **yt-dlp** | æœ€æ–°ç‰ˆ | è§†é¢‘ä¸‹è½½ (è‡ªåŠ¨å®‰è£…) |

### âš™ï¸ é…ç½®è®¾ç½®

#### 1. æ•°æ®åº“å‡†å¤‡

**MySQL (æ¨èç”Ÿäº§ç¯å¢ƒ)**:
```sql
CREATE DATABASE ytb2bili CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'ytb2bili'@'localhost' IDENTIFIED BY 'your_secure_password';
GRANT ALL PRIVILEGES ON ytb2bili.* TO 'ytb2bili'@'localhost';
FLUSH PRIVILEGES;
```

**SQLite (é€‚ç”¨å¼€å‘ç¯å¢ƒ)**:
æ— éœ€é¢å¤–é…ç½®ï¼Œç¨‹åºä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“æ–‡ä»¶ã€‚

#### 2. é…ç½®æ–‡ä»¶è®¾ç½®

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.toml.example config.toml

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano config.toml
```

**åŸºç¡€é…ç½®**:
```toml
# æœåŠ¡é…ç½®
listen = ":8096"                    # æœåŠ¡ç›‘å¬ç«¯å£
environment = "production"           # è¿è¡Œç¯å¢ƒ
debug = false                       # ç”Ÿäº§ç¯å¢ƒå»ºè®®å…³é—­
FileUpDir = "/data/ytb2bili/media"  # æ–‡ä»¶å­˜å‚¨ç›®å½• (éœ€è¦è¶³å¤Ÿç£ç›˜ç©ºé—´)

# æ•°æ®åº“é…ç½®
[database]
  type = "mysql"                    # mysql / postgres / sqlite
  host = "localhost"
  port = 3306
  username = "ytb2bili"
  password = "your_secure_password"
  database = "ytb2bili"
  timezone = "Asia/Shanghai"
```

**äº‘å­˜å‚¨é…ç½® (æ¨è)**:
```toml
# è…¾è®¯äº‘ COS - ç”¨äºå­˜å‚¨è§†é¢‘å’Œå°é¢
[TenCosConfig]
  enabled = true
  CosBucketURL = "https://your-bucket.cos.ap-guangzhou.myqcloud.com"
  CosSecretId = "æ‚¨çš„SecretId"
  CosSecretKey = "æ‚¨çš„SecretKey"
  CosRegion = "ap-guangzhou"
  CosBucket = "your-bucket"
  SubAppId = "æ‚¨çš„AppId"
```

**ç¿»è¯‘æœåŠ¡é…ç½®**:
```toml
# å¯é€šè¿‡ Web ç•Œé¢åŠ¨æ€é…ç½®ï¼Œæ— éœ€åœ¨æ­¤è®¾ç½®
# - ç™¾åº¦ç¿»è¯‘: åœ¨ç³»ç»Ÿè®¾ç½®ä¸­é…ç½® App ID å’Œå¯†é’¥
# - DeepSeek AI: åœ¨ç³»ç»Ÿè®¾ç½®ä¸­é…ç½® API Key
```

### ğŸ”„ å…¶ä»–å¯åŠ¨æ–¹å¼

**å¼€å‘æ¨¡å¼** (ä»£ç å˜æ›´è‡ªåŠ¨é‡å¯):
```bash
# å®‰è£… air å·¥å…·
go install github.com/cosmtrek/air@latest

# å¼€å‘æ¨¡å¼è¿è¡Œ
make dev
```

**ä»…æ„å»ºåç«¯** (è·³è¿‡å‰ç«¯æ„å»º):
```bash
make build-api
./bili-up-api-server
```

**ç”Ÿäº§ä¼˜åŒ–æ„å»º**:
```bash
make build-prod  # å¯ç”¨ç¼–è¯‘ä¼˜åŒ–ï¼Œå‡å°æ–‡ä»¶å¤§å°
```

---

## ğŸ“– API æ–‡æ¡£

### ğŸ¬ è§†é¢‘ç®¡ç† API

<details>
<summary><strong>ğŸ“‹ è·å–è§†é¢‘åˆ—è¡¨</strong></summary>

```http
GET /api/v1/videos?page=1&pageSize=20&status=all
```

**æŸ¥è¯¢å‚æ•°**:
- `page`: é¡µç  (é»˜è®¤: 1)
- `pageSize`: æ¯é¡µæ•°é‡ (é»˜è®¤: 20, æœ€å¤§: 100)
- `status`: çŠ¶æ€ç­›é€‰ (`all`, `pending`, `processing`, `completed`, `failed`)

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "videos": [
      {
        "id": 1,
        "video_id": "dQw4w9WgXcQ",
        "title": "Never Gonna Give You Up",
        "status": "completed",
        "created_at": "2024-01-15T10:30:00Z",
        "bilibili_bvid": "BV1xx411c7mD",
        "progress": 100
      }
    ],
    "total": 150,
    "page": 1,
    "page_size": 20
  }
}
```
</details>

<details>
<summary><strong>ğŸ” è·å–è§†é¢‘è¯¦æƒ… (å«ä»»åŠ¡æ­¥éª¤)</strong></summary>

```http
GET /api/v1/videos/:id
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "data": {
    "video": {
      "id": 1,
      "video_id": "dQw4w9WgXcQ",
      "title": "Never Gonna Give You Up",
      "description": "ç»å…¸éŸ³ä¹è§†é¢‘...",
      "status": "completed",
      "bilibili_bvid": "BV1xx411c7mD"
    },
    "task_steps": [
      {
        "step_name": "ç”Ÿæˆå­—å¹•",
        "step_order": 1,
        "status": "completed",
        "duration": 45,
        "can_retry": false,
        "start_time": "2024-01-15T10:30:00Z",
        "end_time": "2024-01-15T10:30:45Z"
      },
      {
        "step_name": "ç¿»è¯‘å­—å¹•", 
        "step_order": 2,
        "status": "completed",
        "duration": 12
      }
    ]
  }
}
```
</details>

<details>
<summary><strong>ğŸ”„ é‡è¯•ä»»åŠ¡æ­¥éª¤</strong></summary>

```http
POST /api/v1/videos/:id/steps/:stepName/retry
```

**è·¯å¾„å‚æ•°**:
- `id`: è§†é¢‘ID
- `stepName`: æ­¥éª¤åç§° (`ç”Ÿæˆå­—å¹•`, `ç¿»è¯‘å­—å¹•`, `ç”Ÿæˆè§†é¢‘å…ƒæ•°æ®`, `ä¸Šä¼ åˆ°Bilibili`, `ä¸Šä¼ å­—å¹•åˆ°Bilibili`)
</details>

<details>
<summary><strong>ğŸ“ è·å–è§†é¢‘æ–‡ä»¶åˆ—è¡¨</strong></summary>

```http
GET /api/v1/videos/:id/files
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "data": {
    "video_file": "/data/videos/dQw4w9WgXcQ/video.mp4",
    "subtitle_files": [
      "/data/videos/dQw4w9WgXcQ/subtitle.srt",
      "/data/videos/dQw4w9WgXcQ/subtitle_zh.srt"
    ],
    "cover_image": "/data/videos/dQw4w9WgXcQ/cover.jpg",
    "metadata_file": "/data/videos/dQw4w9WgXcQ/metadata.json"
  }
}
```
</details>

<details>
<summary><strong>ğŸš€ æ‰‹åŠ¨ä¸Šä¼ è§¦å‘</strong></summary>

```http
POST /api/v1/videos/:id/upload/video     # æ‰‹åŠ¨ä¸Šä¼ è§†é¢‘
POST /api/v1/videos/:id/upload/subtitle  # æ‰‹åŠ¨ä¸Šä¼ å­—å¹•
```

**ç”¨é€”**: ç»•è¿‡å®šæ—¶è°ƒåº¦ï¼Œç«‹å³æ‰§è¡Œä¸Šä¼ ä»»åŠ¡
</details>

### ğŸ” Bç«™è®¤è¯ API

<details>
<summary><strong>ğŸ“± è·å–ç™»å½•äºŒç»´ç </strong></summary>

```http
GET /api/v1/auth/qrcode
```

**å“åº”**:
```json
{
  "code": 200,
  "data": {
    "auth_code": "abc123...",
    "qrcode_url": "https://passport.bilibili.com/qrcode?code=abc123...",
    "expires_in": 180
  }
}
```
</details>

<details>
<summary><strong>ğŸ–¼ï¸ è·å–äºŒç»´ç å›¾ç‰‡</strong></summary>

```http
GET /api/v1/auth/qrcode/image/:authCode
```

**å“åº”**: PNG å›¾ç‰‡æ•°æ® (Content-Type: image/png)
</details>

<details>
<summary><strong>ğŸ”„ è½®è¯¢ç™»å½•çŠ¶æ€</strong></summary>

```http
POST /api/v1/auth/poll
Content-Type: application/json

{
  "auth_code": "abc123..."
}
```

**å“åº”çŠ¶æ€**:
- `waiting`: ç­‰å¾…æ‰«ç 
- `scanned`: å·²æ‰«ç ï¼Œç­‰å¾…ç¡®è®¤
- `success`: ç™»å½•æˆåŠŸ
- `expired`: äºŒç»´ç è¿‡æœŸ
</details>

<details>
<summary><strong>âœ… æ£€æŸ¥ç™»å½•çŠ¶æ€</strong></summary>

```http
GET /api/v1/auth/status
```

**å“åº”**:
```json
{
  "code": 200,
  "data": {
    "is_logged_in": true,
    "user_info": {
      "username": "ç”¨æˆ·å",
      "avatar": "å¤´åƒURL",
      "uid": 12345678
    }
  }
}
```
</details>

### ğŸ¯ å­—å¹•å¤„ç† API

<details>
<summary><strong>ğŸ’¾ ä¿å­˜è§†é¢‘åˆ°å¤„ç†é˜Ÿåˆ—</strong></summary>

```http
POST /api/v1/subtitles/save
Content-Type: application/json

{
  "url": "https://www.youtube.com/watch?v=dQw4w9WgXcQ",
  "title": "è‡ªå®šä¹‰æ ‡é¢˜ (å¯é€‰)",
  "description": "è‡ªå®šä¹‰æè¿° (å¯é€‰)",
  "operation_type": "auto_process"
}
```

**åŠŸèƒ½**: å°†è§†é¢‘URLæ·»åŠ åˆ°å¤„ç†é˜Ÿåˆ—ï¼Œè‡ªåŠ¨å¼€å§‹ 4 æ­¥å‡†å¤‡æµç¨‹
</details>

### âš™ï¸ ç³»ç»Ÿé…ç½® API

<details>
<summary><strong>ğŸ”§ åŠ¨æ€é…ç½®ç®¡ç†</strong></summary>

```http
GET /api/v1/config              # è·å–å½“å‰é…ç½®
POST /api/v1/config             # æ›´æ–°é…ç½® (ç™¾åº¦ç¿»è¯‘ã€DeepSeekç­‰)
```

**æ”¯æŒåŠ¨æ€é…ç½®çš„æœåŠ¡**:
- ç™¾åº¦ç¿»è¯‘ (App ID, Secret Key)  
- DeepSeek AI (API Key, Model)
- æ–‡ä»¶ä¸Šä¼ è·¯å¾„
- è°ƒè¯•å¼€å…³ç­‰
</details>

---



## ğŸ¯ æ™ºèƒ½å¤„ç†æµç¨‹

### âš¡ 4æ­¥å‡†å¤‡é˜¶æ®µ (å®æ—¶å¤„ç†)

å½“ä½ æ·»åŠ ä¸€ä¸ª YouTube è§†é¢‘URLåï¼Œç³»ç»Ÿä¼šç«‹å³å¼€å§‹ä»¥ä¸‹å¤„ç†æµç¨‹ï¼š

| æ­¥éª¤ | å¤„ç†å™¨ | åŠŸèƒ½æè¿° | å¹³å‡è€—æ—¶ |
|------|--------|----------|----------|
| 1ï¸âƒ£ | **å­—å¹•ç”Ÿæˆ** | ğŸ¤ Whisper AI è¯­éŸ³è¯†åˆ«ï¼Œç”Ÿæˆé«˜ç²¾åº¦å­—å¹•æ–‡ä»¶ | 2-5åˆ†é’Ÿ |
| 2ï¸âƒ£ | **å°é¢ä¸‹è½½** | ğŸ“· ä¸‹è½½é«˜æ¸…å°é¢å›¾ï¼Œä¸Šä¼ åˆ°äº‘å­˜å‚¨è·å–CDNé“¾æ¥ | 10-30ç§’ |
| 3ï¸âƒ£ | **å­—å¹•ç¿»è¯‘** | ğŸŒ æ™ºèƒ½ç¿»è¯‘å­—å¹• (ç™¾åº¦ç¿»è¯‘/DeepSeek AI) | 30-60ç§’ |  
| 4ï¸âƒ£ | **å…ƒæ•°æ®ç”Ÿæˆ** | ğŸ¤– AIåˆ†æè§†é¢‘å†…å®¹ï¼Œç”Ÿæˆç¬¦åˆBç«™è§„èŒƒçš„æ ‡é¢˜ã€æè¿°ã€æ ‡ç­¾ | 30-90ç§’ |

> **ğŸ’¡ æ™ºèƒ½ç‰¹æ€§**:
> - æ”¯æŒ **yt-dlp** çš„æ‰€æœ‰å¹³å° (YouTube, TikTok, Instagram, Twitterç­‰)
> - è‡ªåŠ¨é€‰æ‹©æœ€ä½³è§†é¢‘è´¨é‡ (1080pä¼˜å…ˆ)
> - æ™ºèƒ½è·³è¿‡å·²å­˜åœ¨çš„å¤„ç†æ­¥éª¤
> - å¤±è´¥è‡ªåŠ¨é‡è¯•æœºåˆ¶ (æœ€å¤š3æ¬¡)

### ğŸš€ å®šæ—¶ä¸Šä¼ é˜¶æ®µ (æ™ºèƒ½è°ƒåº¦)

ä¸ºäº†é¿å…é¢‘ç¹ä¸Šä¼ è¢«Bç«™é™åˆ¶ï¼Œç³»ç»Ÿé‡‡ç”¨æ™ºèƒ½è°ƒåº¦ç­–ç•¥ï¼š

```mermaid
graph LR
    A[å‡†å¤‡å®Œæˆ] --> B[ç­‰å¾…ä¸Šä¼ é˜Ÿåˆ—]
    B --> C[è§†é¢‘ä¸Šä¼ <br/>æ¯å°æ—¶1ä¸ª]
    C --> D[ç­‰å¾…1å°æ—¶]
    D --> E[å­—å¹•ä¸Šä¼ <br/>è‡ªåŠ¨å…³è”]
    E --> F[ä¸Šä¼ å®Œæˆ]
```

| é˜¶æ®µ | è°ƒåº¦ç­–ç•¥ | è¯´æ˜ |
|------|----------|------|
| ğŸ¬ **è§†é¢‘ä¸Šä¼ ** | æ¯å°æ—¶1ä¸ª | é¿å…é¢‘ç¹ä¸Šä¼ ï¼Œé™ä½è¢«é™åˆ¶é£é™© |
| ğŸ“ **å­—å¹•ä¸Šä¼ ** | è§†é¢‘ä¸Šä¼ å1å°æ—¶ | ç¡®ä¿è§†é¢‘å®¡æ ¸é€šè¿‡åå†ä¸Šä¼ å­—å¹• |
| ğŸ”„ **æ‰‹åŠ¨è§¦å‘** | ç«‹å³æ‰§è¡Œ | Webç•Œé¢æ”¯æŒè·³è¿‡é˜Ÿåˆ—ç«‹å³ä¸Šä¼  |

### ğŸ“Š ä»»åŠ¡çŠ¶æ€ç³»ç»Ÿ

| çŠ¶æ€ | å›¾æ ‡ | æè¿° | å¯æ“ä½œ |
|------|------|------|--------|
| `pending` | â³ | ç­‰å¾…æ‰§è¡Œ | - |
| `running` | ğŸ”„ | æ­£åœ¨æ‰§è¡Œ | - |
| `completed` | âœ… | å·²å®Œæˆ | âœ“ å¯æŸ¥çœ‹ç»“æœ |
| `failed` | âŒ | æ‰§è¡Œå¤±è´¥ | âœ“ å¯é‡è¯• |
| `skipped` | â­ï¸ | å·²è·³è¿‡ | âœ“ å¯é‡æ–°æ‰§è¡Œ |

### ğŸ›¡ï¸ å®¹é”™æœºåˆ¶

- **ä»»åŠ¡éš”ç¦»**: å•ä¸ªæ­¥éª¤å¤±è´¥ä¸å½±å“å…¶ä»–æ­¥éª¤
- **çŠ¶æ€æ¢å¤**: åº”ç”¨é‡å¯åè‡ªåŠ¨æ¢å¤æ‰§è¡ŒçŠ¶æ€
- **é‡è¯•ç­–ç•¥**: ç½‘ç»œé”™è¯¯è‡ªåŠ¨é‡è¯•ï¼Œå…¶ä»–é”™è¯¯æ‰‹åŠ¨é‡è¯•
- **è¿›åº¦ä¿å­˜**: æ¯ä¸ªæ­¥éª¤çš„æ‰§è¡Œç»“æœéƒ½ä¼šæŒä¹…åŒ–ä¿å­˜
- **èµ„æºç®¡ç†**: æ™ºèƒ½æ¸…ç†ä¸´æ—¶æ–‡ä»¶ï¼Œé¿å…ç£ç›˜ç©ºé—´ä¸è¶³

---

## ğŸ§ª æµ‹è¯•ä¸éªŒè¯

### ğŸš€ åŠŸèƒ½æµ‹è¯•

**1. å¥åº·æ£€æŸ¥**:
```bash
curl http://localhost:8096/health
# é¢„æœŸå“åº”: {"status":"ok","message":"Bili Up Backend API is running"}
```

**2. å®Œæ•´æµç¨‹æµ‹è¯•**:
```bash
# 1. æ£€æŸ¥ç™»å½•çŠ¶æ€
curl http://localhost:8096/api/v1/auth/status

# 2. è·å–ç™»å½•äºŒç»´ç  (å¦‚æœªç™»å½•)  
curl http://localhost:8096/api/v1/auth/qrcode

# 3. æ·»åŠ è§†é¢‘åˆ°å¤„ç†é˜Ÿåˆ—
curl -X POST http://localhost:8096/api/v1/subtitles/save \
  -H "Content-Type: application/json" \
  -d '{"url":"https://www.youtube.com/watch?v=dQw4w9WgXcQ","operation_type":"auto_process"}'

# 4. æŸ¥çœ‹å¤„ç†è¿›åº¦
curl http://localhost:8096/api/v1/videos
```

### ğŸ”§ å¼€å‘æµ‹è¯•

**è¿è¡Œå•å…ƒæµ‹è¯•**:
```bash
make test
# æˆ–
go test -v ./...
```

**ä»£ç è´¨é‡æ£€æŸ¥**:
```bash
make lint    # ä»£ç è§„èŒƒæ£€æŸ¥
make fmt     # ä»£ç æ ¼å¼åŒ–
```

**æ€§èƒ½æµ‹è¯•**:
```bash
# å¹¶å‘APIæµ‹è¯•
ab -n 100 -c 10 http://localhost:8096/health

# å†…å­˜ä½¿ç”¨ç›‘æ§
go tool pprof http://localhost:8096/debug/pprof/heap
```

---

## ğŸ“Š æ•°æ®åº“è®¾è®¡

### æ ¸å¿ƒè¡¨ç»“æ„

<details>
<summary><strong>ğŸ“¹ tb_videos - è§†é¢‘ä¸»è¡¨</strong></summary>

```sql
CREATE TABLE `tb_videos` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é”®',
  `video_id` varchar(100) NOT NULL COMMENT 'YouTubeè§†é¢‘ID',
  `title` varchar(500) DEFAULT NULL COMMENT 'è§†é¢‘æ ‡é¢˜',
  `description` text COMMENT 'è§†é¢‘æè¿°',
  `cover_url` varchar(1000) DEFAULT NULL COMMENT 'å°é¢å›¾ç‰‡URL', 
  `file_path` varchar(1000) DEFAULT NULL COMMENT 'æœ¬åœ°æ–‡ä»¶è·¯å¾„',
  `status` varchar(20) DEFAULT '001' COMMENT 'å¤„ç†çŠ¶æ€: 001-å¾…å¤„ç† 002-å¤„ç†ä¸­ 200-å‡†å¤‡ä¸Šä¼  300-è§†é¢‘å·²ä¸Šä¼  400-å®Œæˆ 999-å¤±è´¥',
  `bilibili_bvid` varchar(20) DEFAULT NULL COMMENT 'Bç«™è§†é¢‘BVå·',
  `bilibili_aid` bigint DEFAULT NULL COMMENT 'Bç«™è§†é¢‘AVå·',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_video_id` (`video_id`),
  KEY `idx_status` (`status`),
  KEY `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='è§†é¢‘ä¸»è¡¨';
```
</details>

<details>
<summary><strong>ğŸ“ task_steps - ä»»åŠ¡æ­¥éª¤è¡¨</strong></summary>

```sql
CREATE TABLE `task_steps` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT,
  `video_id` varchar(100) NOT NULL COMMENT 'å…³è”è§†é¢‘ID',
  `step_name` varchar(100) NOT NULL COMMENT 'æ­¥éª¤åç§°',
  `step_order` int NOT NULL COMMENT 'æ­¥éª¤é¡ºåº',
  `status` enum('pending','running','completed','failed','skipped') DEFAULT 'pending',
  `start_time` timestamp NULL DEFAULT NULL COMMENT 'å¼€å§‹æ—¶é—´',
  `end_time` timestamp NULL DEFAULT NULL COMMENT 'ç»“æŸæ—¶é—´', 
  `duration` int DEFAULT NULL COMMENT 'æ‰§è¡Œè€—æ—¶(ç§’)',
  `error_msg` text COMMENT 'é”™è¯¯ä¿¡æ¯',
  `result_data` json DEFAULT NULL COMMENT 'æ‰§è¡Œç»“æœæ•°æ®',
  `can_retry` tinyint(1) DEFAULT '1' COMMENT 'æ˜¯å¦å¯é‡è¯•',
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_video_step` (`video_id`,`step_name`),
  KEY `idx_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ä»»åŠ¡æ­¥éª¤è¡¨';
```
</details>

<details>
<summary><strong>ğŸ‘¤ tb_users - ç”¨æˆ·è¡¨</strong></summary>

```sql
CREATE TABLE `tb_users` (
  `id` bigint unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(100) NOT NULL COMMENT 'ç”¨æˆ·å',
  `bilibili_uid` bigint DEFAULT NULL COMMENT 'Bç«™UID',
  `avatar_url` varchar(500) DEFAULT NULL COMMENT 'å¤´åƒURL',
  `access_token` text COMMENT 'è®¿é—®ä»¤ç‰Œ',
  `refresh_token` text COMMENT 'åˆ·æ–°ä»¤ç‰Œ',  
  `cookies` text COMMENT 'ç™»å½•Cookie',
  `login_status` tinyint(1) DEFAULT '0' COMMENT 'ç™»å½•çŠ¶æ€',
  `last_login_at` timestamp NULL DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  `updated_at` timestamp NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  UNIQUE KEY `idx_bilibili_uid` (`bilibili_uid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç”¨æˆ·è¡¨';
```
</details>

### çŠ¶æ€æµè½¬å›¾

```mermaid
graph TD
    A[001-å¾…å¤„ç†] --> B[002-å¤„ç†ä¸­]
    B --> C[200-å‡†å¤‡ä¸Šä¼ ] 
    C --> D[300-è§†é¢‘å·²ä¸Šä¼ ]
    D --> E[400-å®Œæˆ]
    B --> F[999-å¤±è´¥]
    F --> B
    C --> F
    D --> F
```

### ç´¢å¼•ä¼˜åŒ–

- **ä¸»é”®ç´¢å¼•**: æ‰€æœ‰è¡¨éƒ½æœ‰è‡ªå¢ä¸»é”®
- **å”¯ä¸€ç´¢å¼•**: video_id, bilibili_uid ä¿è¯æ•°æ®å”¯ä¸€æ€§  
- **çŠ¶æ€ç´¢å¼•**: æŒ‰çŠ¶æ€å¿«é€ŸæŸ¥è¯¢å¾…å¤„ç†ä»»åŠ¡
- **æ—¶é—´ç´¢å¼•**: æŒ‰åˆ›å»ºæ—¶é—´æ’åºå’Œåˆ†é¡µ
- **è”åˆç´¢å¼•**: video_id + step_name ç¡®ä¿æ­¥éª¤å”¯ä¸€æ€§

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### ğŸš« å¸¸è§é—®é¢˜

<details>
<summary><strong>âŒ æ•°æ®åº“è¿æ¥å¤±è´¥</strong></summary>

**é”™è¯¯ç°è±¡**:
```
Error 1045: Access denied for user 'root'@'localhost'
panic: failed to connect to database
```

**è§£å†³æ–¹æ¡ˆ**:
1. **æ£€æŸ¥é…ç½®æ–‡ä»¶**:
   ```bash
   cat config.toml | grep -A 10 "\[database\]"
   ```

2. **éªŒè¯æ•°æ®åº“æœåŠ¡**:
   ```bash
   # MySQL
   sudo systemctl status mysql
   mysql -u root -p -e "SELECT 1"
   
   # æˆ–ä½¿ç”¨ SQLite (æ— éœ€é¢å¤–æœåŠ¡)
   # ä¿®æ”¹ config.toml: type = "sqlite"
   ```

3. **åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·**:
   ```sql
   CREATE DATABASE ytb2bili CHARACTER SET utf8mb4;
   CREATE USER 'ytb2bili'@'localhost' IDENTIFIED BY 'your_password';  
   GRANT ALL ON ytb2bili.* TO 'ytb2bili'@'localhost';
   ```
</details>

<details>
<summary><strong>ğŸ“± Bç«™ç™»å½•é—®é¢˜</strong></summary>

**é—®é¢˜1: äºŒç»´ç æ— æ³•æ˜¾ç¤º**
```bash
# æ£€æŸ¥äºŒç»´ç ç”Ÿæˆæ¥å£
curl http://localhost:8096/api/v1/auth/qrcode
```

**é—®é¢˜2: æ‰«ç åæ— ååº”**
- ç¡®ä¿æ‰‹æœºå’ŒæœåŠ¡å™¨åœ¨åŒä¸€ç½‘ç»œ
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢äº† 8096 ç«¯å£
- å°è¯•ä½¿ç”¨ Bç«™ TV ç‰ˆæœ¬æ‰«ç 

**é—®é¢˜3: ç™»å½•çŠ¶æ€ä¸¢å¤±**
```bash
# æ£€æŸ¥ç™»å½•çŠ¶æ€
curl http://localhost:8096/api/v1/auth/status

# æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯  
tail -f logs/app.log | grep -i "auth\|login"
```
</details>

<details>
<summary><strong>ğŸ¬ è§†é¢‘å¤„ç†å¤±è´¥</strong></summary>

**é—®é¢˜1: yt-dlp ä¸‹è½½å¤±è´¥**
```bash
# æ‰‹åŠ¨æµ‹è¯•ä¸‹è½½
yt-dlp "https://www.youtube.com/watch?v=dQw4w9WgXcQ" --list-formats

# æ›´æ–° yt-dlp åˆ°æœ€æ–°ç‰ˆæœ¬
pip install --upgrade yt-dlp
```

**é—®é¢˜2: å­—å¹•ç”Ÿæˆå¤±è´¥**
- æ£€æŸ¥ Whisper æ¨¡å‹æ˜¯å¦æ­£ç¡®å®‰è£…
- ç¡®ä¿æœ‰è¶³å¤Ÿçš„å†…å­˜ (æ¨è 4GB+)
- æŸ¥çœ‹å…·ä½“é”™è¯¯ä¿¡æ¯é‡è¯•

**é—®é¢˜3: ç¿»è¯‘æœåŠ¡ä¸å¯ç”¨**
```bash
# æµ‹è¯•ç™¾åº¦ç¿»è¯‘é…ç½®
curl -X POST "https://fanyi-api.baidu.com/api/trans/vip/translate" \
  -d "q=hello&from=en&to=zh&appid=YOUR_APP_ID&salt=123&sign=YOUR_SIGN"

# æµ‹è¯• DeepSeek API
curl -X POST "https://api.deepseek.com/chat/completions" \
  -H "Authorization: Bearer YOUR_API_KEY" \
  -d '{"model":"deepseek-chat","messages":[{"role":"user","content":"test"}]}'
```
</details>

<details>
<summary><strong>â˜ï¸ äº‘å­˜å‚¨é—®é¢˜</strong></summary>

**é—®é¢˜1: è…¾è®¯äº‘COSä¸Šä¼ å¤±è´¥**
```bash
# æ£€æŸ¥COSé…ç½®
curl "https://your-bucket.cos.ap-guangzhou.myqcloud.com/"

# éªŒè¯å¯†é’¥æƒé™
# ç¡®ä¿ SecretId/SecretKey æœ‰å­˜å‚¨æ¡¶çš„è¯»å†™æƒé™
```

**é—®é¢˜2: å­˜å‚¨ç©ºé—´ä¸è¶³**
```bash
# æ£€æŸ¥ç£ç›˜ä½¿ç”¨æƒ…å†µ  
df -h /data/ytb2bili/

# æ¸…ç†ä¸´æ—¶æ–‡ä»¶
find /data/ytb2bili/ -name "*.tmp" -delete
find /data/ytb2bili/ -type f -mtime +7 -name "*.mp4" -delete
```
</details>

### ğŸ” è°ƒè¯•æŠ€å·§

**å¼€å¯è°ƒè¯•æ—¥å¿—**:
```toml
# config.toml
debug = true
environment = "development"
```

**æŸ¥çœ‹å®æ—¶æ—¥å¿—**:
```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f logs/app.log

# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
htop
iostat -x 1

# ç›‘æ§ç½‘ç»œè¿æ¥
netstat -tulpn | grep 8096
```

**æ€§èƒ½åˆ†æ**:
```bash
# HTTPè¯·æ±‚åˆ†æ
curl -w "@curl-format.txt" -s -o /dev/null http://localhost:8096/api/v1/videos

# å†…å­˜æ³„æ¼æ£€æµ‹
go tool pprof http://localhost:8096/debug/pprof/heap
```

### ğŸ“ è·å–å¸®åŠ©

å¦‚æœä»¥ä¸Šæ–¹æ³•æ— æ³•è§£å†³é—®é¢˜:

1. **ğŸ“‹ æ”¶é›†ä¿¡æ¯**:
   ```bash
   # ç³»ç»Ÿä¿¡æ¯
   uname -a
   go version
   yt-dlp --version
   
   # é…ç½®ä¿¡æ¯ (æ³¨æ„è„±æ•)
   cat config.toml | grep -v "password\|secret\|key"
   
   # é”™è¯¯æ—¥å¿— (æœ€è¿‘100è¡Œ)
   tail -n 100 logs/app.log
   ```

2. **ğŸ› æäº¤Issue**: è®¿é—® [GitHub Issues](https://github.com/difyz9/ytb2bili/issues)
3. **ğŸ’¬ QQäº¤æµç¾¤**: 773066052 (æŠ€æœ¯äº¤æµå’Œé—®é¢˜è®¨è®º)
4. **ğŸ’¬ ç¤¾åŒºè®¨è®º**: åŠ å…¥é¡¹ç›®è®¨è®ºç¾¤ç»„
5. **ğŸ“§ è”ç³»ä½œè€…**: 

---

## ğŸš€ ç”Ÿäº§éƒ¨ç½²

### ğŸ³ Docker éƒ¨ç½² (æ¨è)

<details>
<summary><strong>ğŸ“¦ ä½¿ç”¨ Docker Compose</strong></summary>

```yaml
# docker-compose.yml
version: '3.8'

services:
  ytb2bili:
    image: ytb2bili:latest
    ports:
      - "8096:8096"
    volumes:
      - ./config.toml:/app/config.toml
      - ./data:/data/ytb2bili
      - ./logs:/app/logs
    environment:
      - CONFIG_FILE=/app/config.toml
    depends_on:
      - mysql
    restart: unless-stopped

  mysql:
    image: mysql:8.0
    environment:
      MYSQL_ROOT_PASSWORD: your_secure_password
      MYSQL_DATABASE: ytb2bili
      MYSQL_USER: ytb2bili
      MYSQL_PASSWORD: your_app_password
    volumes:
      - mysql_data:/var/lib/mysql
    restart: unless-stopped

volumes:
  mysql_data:
```

å¯åŠ¨æœåŠ¡:
```bash
docker-compose up -d
```
</details>

### ğŸŒ Nginx åå‘ä»£ç†

<details>
<summary><strong>âš¡ é…ç½®ç¤ºä¾‹</strong></summary>

```nginx
# /etc/nginx/sites-available/ytb2bili.conf
server {
    listen 80;
    server_name your-domain.com;
    
    # é‡å®šå‘åˆ° HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;
    
    ssl_certificate /etc/ssl/certs/your-domain.crt;
    ssl_certificate_key /etc/ssl/private/your-domain.key;
    
    # å®‰å…¨é…ç½®
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512;
    ssl_prefer_server_ciphers off;
    
    # å¢åŠ ä¸Šä¼ å¤§å°é™åˆ¶
    client_max_body_size 10G;
    client_body_timeout 300s;
    
    location / {
        proxy_pass http://localhost:8096;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocket æ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # é•¿è¿æ¥æ”¯æŒ
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s; 
        proxy_read_timeout 300s;
    }
    
    # é™æ€èµ„æºç¼“å­˜
    location /_next/static/ {
        proxy_pass http://localhost:8096;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```
</details>

### ğŸ“Š ç›‘æ§ä¸æ—¥å¿—

<details>
<summary><strong>ğŸ“ˆ Prometheus ç›‘æ§</strong></summary>

```yaml
# prometheus.yml
scrape_configs:
  - job_name: 'ytb2bili'
    static_configs:
      - targets: ['localhost:8096']
    metrics_path: /metrics
    scrape_interval: 30s
```

**å†…ç½®ç›‘æ§æŒ‡æ ‡**:
- HTTP è¯·æ±‚æ•°é‡å’Œå»¶è¿Ÿ
- ä»»åŠ¡å¤„ç†æˆåŠŸ/å¤±è´¥ç‡
- æ•°æ®åº“è¿æ¥æ± çŠ¶æ€
- ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ
</details>

### ğŸ” å®‰å…¨å»ºè®®

- âœ… **HTTPS éƒ¨ç½²**: ä½¿ç”¨ SSL è¯ä¹¦ä¿æŠ¤æ•°æ®ä¼ è¾“
- âœ… **è®¿é—®æ§åˆ¶**: é…ç½®é˜²ç«å¢™é™åˆ¶è®¿é—®æ¥æº
- âœ… **å®šæœŸå¤‡ä»½**: è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“å’Œé…ç½®æ–‡ä»¶
- âœ… **å¯†é’¥ç®¡ç†**: ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡
- âœ… **æ›´æ–°ç»´æŠ¤**: å®šæœŸæ›´æ–°ä¾èµ–å’Œç³»ç»Ÿè¡¥ä¸

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### ğŸ’¡ å¦‚ä½•è´¡çŒ®

æˆ‘ä»¬æ¬¢è¿å„ç§å½¢å¼çš„è´¡çŒ®ï¼

**ğŸ› æŠ¥å‘Šé—®é¢˜**:
- ä½¿ç”¨ [GitHub Issues](https://github.com/difyz9/ytb2bili/issues)
- æä¾›è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œé‡ç°æ­¥éª¤
- åŒ…å«ç³»ç»Ÿç¯å¢ƒå’Œç‰ˆæœ¬ä¿¡æ¯

**âœ¨ åŠŸèƒ½å»ºè®®**:
- åœ¨ Issues ä¸­æè¿°æ–°åŠŸèƒ½éœ€æ±‚
- è¯´æ˜ä½¿ç”¨åœºæ™¯å’Œé¢„æœŸæ•ˆæœ
- å‚ä¸åŠŸèƒ½è®¾è®¡è®¨è®º

**ğŸ”§ ä»£ç è´¡çŒ®**:
```bash
# Fork é¡¹ç›®å¹¶å…‹éš†
git clone https://github.com/your-username/ytb2bili.git
cd ytb2bili

# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/your-feature-name

# æäº¤æ›´æ”¹
git commit -m "feat: add your feature description"

# æ¨é€å¹¶åˆ›å»º Pull Request
git push origin feature/your-feature-name
```

### ğŸ“‹ å¼€å‘è§„èŒƒ

- **ä»£ç é£æ ¼**: éµå¾ª Go å®˜æ–¹è§„èŒƒï¼Œä½¿ç”¨ `gofmt` æ ¼å¼åŒ–
- **æäº¤ä¿¡æ¯**: ä½¿ç”¨è¯­ä¹‰åŒ–æäº¤ (feat/fix/docs/style/refactor/test/chore)
- **æµ‹è¯•è¦†ç›–**: æ–°åŠŸèƒ½éœ€è¦åŒ…å«ç›¸åº”çš„å•å…ƒæµ‹è¯•
- **æ–‡æ¡£æ›´æ–°**: æ›´æ–°ç›¸å…³çš„ README å’Œ API æ–‡æ¡£

---
<div align="center">

**ğŸ‰ æ„Ÿè°¢ä½¿ç”¨ YTB2BILIï¼**

å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸ 

[ğŸ› æŠ¥å‘Šé—®é¢˜](https://github.com/difyz9/ytb2bili/issues) â€¢ 
[ğŸ’¡ åŠŸèƒ½å»ºè®®](https://github.com/difyz9/ytb2bili/issues) â€¢ 
[ğŸ“– æ–‡æ¡£](https://github.com/difyz9/ytb2bili/wiki) â€¢ 
[ğŸ’¬ QQç¾¤](https://qm.qq.com/cgi-bin/qm/qr?k=773066052) â€¢ 
[ğŸ’¬ è®¨è®º](https://github.com/difyz9/ytb2bili/discussions)
<img src="img/751763091471_.pic.jpg" alt="å¾®ä¿¡è”ç³»" width="200"/>

</div>

---

## ğŸ“„ è®¸å¯åè®®

æœ¬é¡¹ç›®é‡‡ç”¨ [MIT License](LICENSE) å¼€æºåè®®ã€‚

```
MIT License

Copyright (c) 2024 YTB2BILI

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software...
```



